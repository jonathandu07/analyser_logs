🛡️ Rapport de sécurité – 28/06/2025 à 16h00
==========================================================

📌 Uptime et charge système :
 16:00:03 up 16 days, 22:27,  1 user,  load average: 0.00, 0.00, 0.00

📌 Connexions SSH actives :
root     pts/2        Jun 19 14:08 (tmux(75255).%0)

📌 Derniers redémarrages :
reboot   system boot  6.1.0-34-arm64   Wed Jun 11 17:32   still running
reboot   system boot  6.1.0-34-arm64   Wed Jun 11 16:48   still running
reboot   system boot  6.1.0-34-arm64   Tue May 27 18:36   still running
reboot   system boot  6.1.0-33-arm64   Sat Apr 26 00:29   still running

wtmp begins Sat Apr 26 00:29:50 2025

📌 Utilisation disque :
Filesystem      Size  Used Avail Use% Mounted on
udev            940M     0  940M   0% /dev
tmpfs           198M  1.2M  197M   1% /run
/dev/vda2        28G   22G  5.3G  81% /
tmpfs           989M     0  989M   0% /dev/shm
tmpfs           5.0M     0  5.0M   0% /run/lock
/dev/loop1       53M   53M     0 100% /snap/certbot/4728
/dev/loop3       62M   62M     0 100% /snap/core24/992
/dev/loop2       45M   45M     0 100% /snap/snapd/24509
/dev/vda1       512M  6.1M  506M   2% /boot/efi
/dev/loop4       53M   53M     0 100% /snap/certbot/4738
tmpfs           198M  4.0K  198M   1% /run/user/1000
overlay          28G   22G  5.3G  81% /var/lib/docker/overlay2/5660e34359f15c4f7a1057a2e9fd177619a17269b69f251838a2d5d55b937c09/merged
overlay          28G   22G  5.3G  81% /var/lib/docker/overlay2/c8a1d2e12effca01832468cef9a6c17f8dd37c14fad0c48cddd4fd0df289d136/merged
/dev/loop0       45M   45M     0 100% /snap/snapd/24724
/dev/loop5       62M   62M     0 100% /snap/core24/1010

📌 Utilisation mémoire (RAM + Swap) :
               total        used        free      shared  buff/cache   available
Mem:           1.9Gi       773Mi        51Mi       328Ki       1.2Gi       1.2Gi
Swap:          975Mi       391Mi       584Mi

📌 Détail mémoire :
RAM utilisée : 773 MiB / 1977 MiB (39.10%)
SWAP utilisée : 391 MiB / 975 MiB (40.10%)

📌 Top 10 processus utilisant le plus de RAM :
USER         PID %MEM   RSS COMMAND
root       75272  9.4 191124 node
999        54130  7.2 146068 mysqld
root       54476  5.1 103948 gunicorn
root        6803  3.4 70496 systemd-journal
root       75260  2.3 46736 npm run dev --h
mysql      47228  2.0 40888 mariadbd
root       53856  1.6 34416 dockerd
root       72778  1.5 31752 snapd
root       75288  1.2 25608 esbuild
root         505  1.0 20912 containerd

📌 Nombre total de processus par utilisateur (top 5) :
    104 root
      2 www-data
      2 jonathan
      1 systemd-timesync
      1 mysql

📌 Consommation mémoire par type de processus :
node                 : 9.40%
mysqld               : 7.20%
gunicorn             : 5.50%
systemd-journal      : 3.40%
mariadbd             : 2.00%
dockerd              : 1.60%
snapd                : 1.50%
esbuild              : 1.20%
containerd           : 1.00%
nginx                : 0.90%
systemd              : 0.80%
containerd-shim      : 0.70%
dhclient             : 0.50%
docker-proxy         : 0.40%
systemd-timesyn      : 0.30%

📌 Top processus gourmands CPU :
USER         PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
root      124585  8.3  0.1   3792  2776 ?        S    16:00   0:00 /bin/bash ./analyser_logs.sh
999        54130  0.3  7.2 1740852 146068 ?      Ssl  Jun13  72:38 mysqld
root       75288  0.0  1.2 1237216 25608 pts/2   Sl+  Jun19   7:00 /var/www/sarahHasaera/node_modules/@esbuild/linux-arm64/bin/esbuild --service=0.25.2 --ping
root       75272  0.0  9.4 5586204 191124 pts/2  Sl+  Jun19   6:29 node /var/www/sarahHasaera/node_modules/.bin/../vite/bin/vite.js --host
root         505  0.0  1.0 1340504 20912 ?       Ssl  Jun11   9:18 /usr/bin/containerd
root       53856  0.0  1.6 1901960 34416 ?       Ssl  Jun13   7:56 /usr/sbin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock
root       54107  0.0  0.4  31236  8136 ?        Ss   Jun13   5:13 /usr/local/bin/python3.12 /usr/local/bin/gunicorn --chdir /app --bind 0.0.0.0:8000 main.wsgi:application --access-logfile - --error-logfile -
mysql      47228  0.0  2.0 1146724 40888 ?       Ssl  Jun13   3:08 /usr/sbin/mariadbd
root      122476  0.0  0.0      0     0 ?        I    06:40   0:02 [kworker/0:3-events]

📌 Ports ouverts (hors localhost) :
Netid State  Recv-Q Send-Q Local Address:Port  Peer Address:PortProcess
udp   UNCONN 0      0            0.0.0.0:68         0.0.0.0:*          
udp   UNCONN 0      0            0.0.0.0:68         0.0.0.0:*          
udp   UNCONN 0      0            0.0.0.0:68         0.0.0.0:*          
udp   UNCONN 0      0            0.0.0.0:68         0.0.0.0:*          
udp   UNCONN 0      0            0.0.0.0:68         0.0.0.0:*          
tcp   LISTEN 0      4096         0.0.0.0:8010       0.0.0.0:*          
tcp   LISTEN 0      511          0.0.0.0:80         0.0.0.0:*          
tcp   LISTEN 0      128          0.0.0.0:22         0.0.0.0:*          
tcp   LISTEN 0      511          0.0.0.0:443        0.0.0.0:*          
tcp   LISTEN 0      4096            [::]:8010          [::]:*          
tcp   LISTEN 0      511             [::]:80            [::]:*          
tcp   LISTEN 0      511                *:5173             *:*          
tcp   LISTEN 0      128             [::]:22            [::]:*          

📌 Services en échec :
  UNIT           LOAD      ACTIVE SUB    DESCRIPTION
* radarr.service not-found failed failed radarr.service
* sonarr.service not-found failed failed sonarr.service

LOAD   = Reflects whether the unit definition was properly loaded.
ACTIVE = The high-level unit activation state, i.e. generalization of SUB.
SUB    = The low-level unit activation state, values depend on unit type.
2 loaded units listed.

📌 Derniers paquets installés :
2025-06-19 13:37:43 install python3-talloc:arm64 <none> 2.4.0-f2
2025-06-19 13:37:44 install python3-samba:arm64 <none> 2:4.17.12+dfsg-0+deb12u1
2025-06-19 13:38:46 install samba-common:all <none> 2:4.17.12+dfsg-0+deb12u1
2025-06-19 13:38:46 install samba-common-bin:arm64 <none> 2:4.17.12+dfsg-0+deb12u1
2025-06-19 13:39:08 install samba-dsdb-modules:arm64 <none> 2:4.17.12+dfsg-0+deb12u1
2025-06-19 13:39:18 install smbclient:arm64 <none> 2:4.17.12+dfsg-0+deb12u1
2025-06-19 14:07:48 install libevent-core-2.1-7:arm64 <none> 2.1.12-stable-8
2025-06-19 14:08:13 install libutempter0:arm64 <none> 1.2.1-3
2025-06-19 14:08:14 install tmux:arm64 <none> 3.3a-3
2025-06-20 10:26:49 install bc:arm64 <none> 1.07.1-3

📌 Utilisateurs système :
_apt
backup
bin
daemon
games
irc
jonathan
list
lp
mail
man
messagebus
mysql
news
nobody
proxy
root
sshd
sync
sys
systemd-network
systemd-timesync
uucp
www-data

📌 Utilisateurs autorisés sudo :
sudo:x:27:

📌 Tentatives sudo échouées :
Jun 13 19:47:29 nac sudo[4455]: pam_unix(sudo:auth): authentication failure; logname=jonathan uid=1000 euid=0 tty=/dev/pts/0 ruser=jonathan rhost=  user=jonathan
Jun 13 19:47:44 nac sudo[4457]: pam_unix(sudo:auth): authentication failure; logname=jonathan uid=1000 euid=0 tty=/dev/pts/0 ruser=jonathan rhost=  user=jonathan

📌 Vérification des logs web (Nginx/Apache/autres) :
⚠️ /var/log/nginx/access.log est vide.
❌ /var/log/apache2/access.log est introuvable.
❌ /var/www/sarahHasaera/logs/access.log est introuvable.

📌 IPs actives dans les logs :

🚨 Recherche d’activité suspecte :

🔎 Failed password dans /var/log/nginx/access.log :

🔎 Invalid user dans /var/log/nginx/access.log :

🔎 authentication failure dans /var/log/nginx/access.log :

🔎 Did not receive identification string dans /var/log/nginx/access.log :

🔎 possible break-in attempt dans /var/log/nginx/access.log :

🔎 403 dans /var/log/nginx/access.log :

🔎 404 dans /var/log/nginx/access.log :

🔎 SQL syntax dans /var/log/nginx/access.log :

🔎 wp-login dans /var/log/nginx/access.log :
