🛡️ Rapport de sécurité – 19/10/2025 à 23h49
==========================================================

📌 Uptime et charge système :
 23:49:57 up 9 days, 13:54,  1 user,  load average: 10.25, 13.67, 21.45

📌 Connexions SSH actives :
jonathan ttyAMA0      Oct 10 10:02

📌 Derniers redémarrages :
reboot   system boot  6.1.0-37-arm64   Fri Oct 10 09:56   still running
reboot   system boot  6.1.0-37-arm64   Thu Oct  9 09:20   still running
reboot   system boot  6.1.0-37-arm64   Tue Aug 19 16:10   still running
reboot   system boot  6.1.0-37-arm64   Sat Aug  9 06:23   still running
reboot   system boot  6.1.0-37-arm64   Wed Jul  9 04:21   still running
reboot   system boot  6.1.0-37-arm64   Thu Jul  3 20:14   still running
reboot   system boot  6.1.0-34-arm64   Wed Jun 11 17:32   still running
reboot   system boot  6.1.0-34-arm64   Wed Jun 11 16:48   still running
reboot   system boot  6.1.0-34-arm64   Tue May 27 18:36   still running
reboot   system boot  6.1.0-33-arm64   Sat Apr 26 00:29   still running

📌 Utilisation disque :
Filesystem      Size  Used Avail Use% Mounted on
udev            940M     0  940M   0% /dev
tmpfs           198M  928K  197M   1% /run
/dev/vda2        28G   24G  2.7G  91% /
tmpfs           989M     0  989M   0% /dev/shm
tmpfs           5.0M     0  5.0M   0% /run/lock
/dev/loop1       67M   67M     0 100% /snap/certbot/5058
/dev/loop3       62M   62M     0 100% /snap/core24/1152
/dev/loop2       92M   92M     0 100% /snap/core/17250
/dev/loop0       67M   67M     0 100% /snap/certbot/4966
/dev/loop5       45M   45M     0 100% /snap/snapd/25205
/dev/loop4       62M   62M     0 100% /snap/core24/1197
/dev/loop6       43M   43M     0 100% /snap/snapd/24787
/dev/vda1       512M  6.1M  506M   2% /boot/efi
tmpfs           198M  4.0K  198M   1% /run/user/1000

📌 Utilisation mémoire (RAM + Swap) :
               total        used        free      shared  buff/cache   available
Mem:           1.9Gi       299Mi       1.5Gi        76Ki       216Mi       1.6Gi
Swap:          975Mi        52Mi       923Mi

📌 Détail mémoire :
RAM utilisée : 302 MiB / 1977 MiB (15.28%)
SWAP utilisée : 52 MiB / 975 MiB (5.33%)

📌 Top 10 processus utilisant le plus de RAM :
USER         PID %MEM   RSS COMMAND
jonathan  167135  2.8 58684 npm run preview
jonathan  167683  2.8 58548 npm run dev --h
root      168064  1.6 33824 snapd
root         996  0.6 13948 containerd
root      168057  0.5 10232 systemd-journal
root           1  0.3  6480 systemd
root      168138  0.1  3692 ps
root      168045  0.1  2748 analyser_logs.s
root      168140  0.1  2488 dockerd
systemd+  143964  0.0  1292 systemd-timesyn

📌 Nombre total de processus par utilisateur (top 5) :
     84 root
      3 jonathan
      1 systemd-timesync
      1 messagebus

📌 Consommation mémoire par type de processus :
snapd                : 1.60%
containerd           : 0.70%
systemd-journal      : 0.50%
systemd              : 0.30%
ps                   : 0.10%
dockerd              : 0.10%
analyser_logs.s      : 0.10%
zswap-shrink         : 0.00%
writeback            : 0.00%
watchdogd            : 0.00%
tpm_dev_wq           : 0.00%
tls-strp             : 0.00%
systemd-udevd        : 0.00%
systemd-timesyn      : 0.00%
sshd                 : 0.00%

📌 Top processus gourmands CPU :
USER         PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
root          44  7.0  0.0      0     0 ?        S    Oct10 966:47 [kswapd0]
root           1  1.1  0.3 168840  6480 ?        Ss   Oct10 158:31 /sbin/init
root         996  1.1  0.7 1340504 14384 ?       Ssl  Oct10 156:38 /usr/bin/containerd
root      168064  1.0  1.6 1699344 33824 ?       Ssl  23:51   0:00 /usr/lib/snapd/snapd
root          14  0.0  0.0      0     0 ?        I    Oct10  12:11 [rcu_sched]
message+     509  0.0  0.0   9460   252 ?        Ss   Oct10   8:02 /usr/bin/dbus-daemon --system --address=systemd: --nofork --nopidfile --systemd-activation --syslog-only
jonathan  167683  0.0  2.8 846316 58548 ?        Dsl  23:37   0:00 npm run dev --host 0.0.0.0 --port 5173
root         508  0.0  0.0   3684   760 ?        Ss   Oct10   7:27 /usr/sbin/cron -f
root     4179129  0.0  0.0  26268   928 ?        Ss   Oct18   0:56 /lib/systemd/systemd-udevd

📌 Ports ouverts (hors localhost) :
Netid State  Recv-Q Send-Q Local Address:Port  Peer Address:PortProcess
udp   UNCONN 0      0            0.0.0.0:68         0.0.0.0:*          
tcp   LISTEN 0      128          0.0.0.0:22         0.0.0.0:*          
tcp   LISTEN 0      128             [::]:22            [::]:*          

📌 Services en échec :
  UNIT                       LOAD   ACTIVE SUB    DESCRIPTION
* mariadb.service            loaded failed failed MariaDB 10.11.11 database server
* nginx.service              loaded failed failed A high performance web server and a reverse proxy server
* sarahHasaera.service       loaded failed failed App SarahHasaera - Production server
* snap.certbot.renew.service loaded failed failed Service for snap application certbot.renew
* snapd.seeded.service       loaded failed failed Wait until snapd is fully seeded
* systemd-logind.service     loaded failed failed User Login Management
* user@1000.service          loaded failed failed User Manager for UID 1000

LOAD   = Reflects whether the unit definition was properly loaded.
ACTIVE = The high-level unit activation state, i.e. generalization of SUB.
SUB    = The low-level unit activation state, values depend on unit type.
7 loaded units listed.

📌 Derniers paquets installés :

📌 Utilisateurs système :
_apt
backup
bin
daemon
games
irc
jonathan
list
lp
mail
man
messagebus
mysql
news
nobody
proxy
root
sshd
sync
sys
systemd-network
systemd-timesync
uucp
www-data

📌 Utilisateurs autorisés sudo :
sudo:x:27:

📌 Tentatives sudo échouées :

📌 Vérification des logs web (Nginx/Apache/autres) :
⚠️ /var/log/nginx/access.log est vide.
❌ /var/log/apache2/access.log est introuvable.
❌ /var/www/sarahHasaera/logs/access.log est introuvable.

📌 IPs actives dans les logs :

🚨 Recherche d’activité suspecte :

🔎 Failed password dans /var/log/nginx/access.log :

🔎 Invalid user dans /var/log/nginx/access.log :

🔎 authentication failure dans /var/log/nginx/access.log :

🔎 Did not receive identification string dans /var/log/nginx/access.log :

🔎 possible break-in attempt dans /var/log/nginx/access.log :

🔎 403 dans /var/log/nginx/access.log :

🔎 404 dans /var/log/nginx/access.log :

🔎 SQL syntax dans /var/log/nginx/access.log :

🔎 wp-login dans /var/log/nginx/access.log :
