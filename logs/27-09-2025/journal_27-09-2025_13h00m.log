🛡️ Rapport de sécurité – 27/09/2025 à 13h00
==========================================================

📌 Uptime et charge système :
 13:00:02 up 38 days, 20:49,  2 users,  load average: 2.96, 2.85, 2.51

📌 Connexions SSH actives :
jonathan ttyAMA0      Aug 19 16:22
jonathan pts/4        Sep 27 11:44 (192.168.1.165)

📌 Derniers redémarrages :
reboot   system boot  6.1.0-37-arm64   Tue Aug 19 16:10   still running
reboot   system boot  6.1.0-37-arm64   Sat Aug  9 06:23   still running
reboot   system boot  6.1.0-37-arm64   Wed Jul  9 04:21   still running
reboot   system boot  6.1.0-37-arm64   Thu Jul  3 20:14   still running
reboot   system boot  6.1.0-34-arm64   Wed Jun 11 17:32   still running
reboot   system boot  6.1.0-34-arm64   Wed Jun 11 16:48   still running
reboot   system boot  6.1.0-34-arm64   Tue May 27 18:36   still running
reboot   system boot  6.1.0-33-arm64   Sat Apr 26 00:29   still running

wtmp begins Sat Apr 26 00:29:50 2025

📌 Utilisation disque :
Filesystem      Size  Used Avail Use% Mounted on
udev            940M     0  940M   0% /dev
tmpfs           198M  932K  197M   1% /run
/dev/vda2        28G   25G  1.8G  94% /
tmpfs           989M     0  989M   0% /dev/shm
tmpfs           5.0M     0  5.0M   0% /run/lock
/dev/loop0       53M   53M     0 100% /snap/certbot/4890
/dev/loop4       43M   43M     0 100% /snap/snapd/24787
/dev/loop5       62M   62M     0 100% /snap/core24/1059
/dev/vda1       512M  6.1M  506M   2% /boot/efi
tmpfs           198M  4.0K  198M   1% /run/user/1000
/dev/loop6       45M   45M     0 100% /snap/snapd/25205
/dev/loop3       92M   92M     0 100% /snap/core/17250
/dev/loop7       67M   67M     0 100% /snap/certbot/4966
/dev/loop1       62M   62M     0 100% /snap/core24/1152

📌 Utilisation mémoire (RAM + Swap) :
               total        used        free      shared  buff/cache   available
Mem:           1.9Gi       305Mi        86Mi       980Ki       1.6Gi       1.6Gi
Swap:          975Mi        65Mi       910Mi

📌 Détail mémoire :
RAM utilisée : 305 MiB / 1977 MiB (15.43%)
SWAP utilisée : 65 MiB / 975 MiB (6.67%)

📌 Top 10 processus utilisant le plus de RAM :
USER         PID %MEM   RSS COMMAND
jonathan  161581  4.0 81664 node
jonathan  161566  2.9 59036 npm run dev --h
root         612  1.8 38140 dockerd
root       34914  1.3 27880 snapd
root      161591  0.8 17300 systemctl
root      161496  0.6 12788 systemd-journal
root           1  0.5 11268 systemd
root      161117  0.5 10204 sshd
jonathan    2273  0.4  9600 systemd
root       86906  0.3  7504 nginx

📌 Nombre total de processus par utilisateur (top 5) :
    105 root
      8 jonathan
      2 www-data
      1 systemd-timesync
      1 messagebus

📌 Consommation mémoire par type de processus :
node                 : 4.00%
dockerd              : 1.80%
snapd                : 1.30%
sshd                 : 1.10%
systemd              : 0.90%
systemctl            : 0.80%
nginx                : 0.70%
systemd-journal      : 0.60%
bash                 : 0.50%
systemd-timesyn      : 0.30%
systemd-logind       : 0.30%
dpkg                 : 0.30%
systemd-udevd        : 0.20%
su                   : 0.20%
frontend             : 0.20%

📌 Top processus gourmands CPU :
USER         PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
root      161641  100  0.1   8156  3708 ?        R    13:00   0:00 ps aux --sort=-%cpu
root      161600  7.6  0.1   3792  2796 ?        S    13:00   0:00 /bin/bash ./analyser_logs.sh
root         612  1.4  1.8 1901896 38140 ?       Ssl  Aug19 804:44 /usr/sbin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock
jonathan  161581  0.4  4.0 760216 81664 ?        Dl   12:57   0:00 node /var/www/sarahHasaera/node_modules/.bin/vite --host
jonathan  161566  0.3  2.9 846532 59036 ?        Ssl  12:57   0:00 npm run dev --host
root          14  0.1  0.0      0     0 ?        I    Aug19  60:05 [rcu_sched]
root       37327  0.0  0.2  67764  4752 ?        S    Aug23  44:10 apt-get purge -y certbot python3-certbot-nginx python3-openssl
root      161496  0.0  0.6  41512 12788 ?        Ss   12:50   0:00 /lib/systemd/systemd-journald
jonathan  161123  0.0  0.3  20060  6928 ?        S    11:44   0:02 sshd: jonathan@pts/4

📌 Ports ouverts (hors localhost) :
Netid State  Recv-Q Send-Q Local Address:Port Peer Address:PortProcess
udp   UNCONN 0      0            0.0.0.0:68        0.0.0.0:*          
tcp   LISTEN 0      511          0.0.0.0:443       0.0.0.0:*          
tcp   LISTEN 0      128          0.0.0.0:22        0.0.0.0:*          
tcp   LISTEN 0      511          0.0.0.0:80        0.0.0.0:*          
tcp   LISTEN 0      128             [::]:22           [::]:*          
tcp   LISTEN 0      511             [::]:80           [::]:*          

📌 Services en échec :
  UNIT                          LOAD      ACTIVE SUB    DESCRIPTION
* mnt-radarr.mount              masked    failed failed mnt-radarr.mount
* mnt-sonarr.mount              masked    failed failed mnt-sonarr.mount
* certbot.service               not-found failed failed certbot.service
* mariadb.service               loaded    failed failed MariaDB 10.11.11 database server
* sarahHasaera.service          loaded    failed failed App SarahHasaera - Production server
* snap.certbot.renew.service    loaded    failed failed Service for snap application certbot.renew
* snapd.seeded.service          loaded    failed failed Wait until snapd is fully seeded
* systemd-journal-flush.service loaded    failed failed Flush Journal to Persistent Storage

LOAD   = Reflects whether the unit definition was properly loaded.
ACTIVE = The high-level unit activation state, i.e. generalization of SUB.
SUB    = The low-level unit activation state, values depend on unit type.
8 loaded units listed.

📌 Derniers paquets installés :

📌 Utilisateurs système :
_apt
backup
bin
daemon
games
irc
jonathan
list
lp
mail
man
messagebus
mysql
news
nobody
proxy
root
sshd
sync
sys
systemd-network
systemd-timesync
uucp
www-data

📌 Utilisateurs autorisés sudo :
sudo:x:27:

📌 Tentatives sudo échouées :

📌 Vérification des logs web (Nginx/Apache/autres) :
✅ /var/log/nginx/access.log existe et contient des données.
❌ /var/log/apache2/access.log est introuvable.
❌ /var/www/sarahHasaera/logs/access.log est introuvable.

📌 IPs actives dans les logs :
    111 192.168.1.10
      6 127.0.0.1
      3 137.0.0.0
      2 192.168.1.197
      2 192.168.1.165
      2 108.0.0.0
      1 134.0.0.0

🚨 Recherche d’activité suspecte :

🔎 Failed password dans /var/log/nginx/access.log :

🔎 Invalid user dans /var/log/nginx/access.log :

🔎 authentication failure dans /var/log/nginx/access.log :

🔎 Did not receive identification string dans /var/log/nginx/access.log :

🔎 possible break-in attempt dans /var/log/nginx/access.log :

🔎 403 dans /var/log/nginx/access.log :

🔎 404 dans /var/log/nginx/access.log :
192.168.1.10 - - [27/Sep/2025:12:27:59 +0200] "GET /favicon.ico HTTP/1.1" 404 555 "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/137.0.0.0 Safari/537.36"

🔎 SQL syntax dans /var/log/nginx/access.log :

🔎 wp-login dans /var/log/nginx/access.log :
